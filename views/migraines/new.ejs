<%- contentFor('body') %>

<div class="flex min-h-full flex-col justify-center px-6 py-5 lg:px-8">
    <div class="sm:mx-auto sm:w-full sm:max-w-sm">
        <h2 class="mt-5 text-center text-2xl font-bold leading-9 tracking-tight">Record New Migraine Episode</h2>
    </div>

    <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-sm">
        <form class="space-y-6" action="/migraines" method="POST">
            <div>
                <label for="attackType" class="block text-sm font-medium leading-6">Attack Type</label>
                <select id="attackType" name="attackType" required class="bg-indigo-100 mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                    <option value="headache">Headache</option>
                    <option value="migraine">Migraine</option>
                    <option value="misc symptoms">Misc Symptoms</option>
                </select>
            </div>

            <div>
                <label for="date" class="block text-sm font-medium leading-6">Date</label>
                <input type="date" id="date" name="date" required class="bg-indigo-100 mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>

            <div hidden>
                <label for="duration" class="block text-sm font-medium leading-6">Duration (minutes)</label>
                <input type="number" id="duration" name="duration" min="0" class="mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>

            <div>
                <label for="pain-level" class="block text-sm font-medium leading-6">Pain Level</label>
                <fieldset id="pain-level" class="grid mt-2 w-auto grid-cols-6 gap-2 rounded-xl bg-indigo-100 p-2">
                    <div>
                        <input type="radio" id="0" value="0" name="painLevel" class="peer hidden"/>
                        <label for="0" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-green-600 peer-checked:font-bold peer-checked:text-white">0</label>
                    </div>
    
                    <div>
                        <input type="radio" id="1" value="1" name="painLevel" class="peer hidden"/>
                        <label for="1" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-yellow-400/90 peer-checked:font-bold peer-checked:text-white">1</label>
                    </div>
            
                    <div>
                        <input type="radio" id="2" value="2" name="painLevel" class="peer hidden" />
                        <label for="2" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-yellow-500 peer-checked:font-bold peer-checked:text-white">2</label>
                    </div>
            
                    <div>
                        <input type="radio" id="3" value="3" name="painLevel" class="peer hidden" />
                        <label for="3" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-orange-400 peer-checked:font-bold peer-checked:text-white">3</label>
                    </div>
            
                    <div>
                        <input type="radio" id="4" value="4" name="painLevel" class="peer hidden" />
                        <label for="4" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-orange-600 peer-checked:font-bold peer-checked:text-white">4</label>
                    </div>
    
                    <div>
                        <input type="radio" id="5" value="5" name="painLevel" class="peer hidden" />
                        <label for="5" class="block cursor-pointer select-none rounded-xl p-2 text-center font-bold text-indigo-600 peer-checked:bg-red-800 peer-checked:font-bold peer-checked:text-white">5</label>
                    </div>
                </fieldset>
            </div>

            <div>
                <span class="block text-sm font-medium leading-6 mb-2">Pain Location</span>
                <div class="space-y-2">
                    <% ['left', 'right', 'front', 'back', 'entire head'].forEach(function(location) { %>
                        <div class="flex items-center">
                            <input type="checkbox" id="<%= location %>" name="painLocation" value="<%= location %>" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600">
                            <label for="<%= location %>" class="ml-2 block text-sm"><%= location.charAt(0).toUpperCase() + location.slice(1) %></label>
                        </div>
                    <% }); %>
                </div>
            </div>

            <div>
                <label for="notes" class="block text-sm font-medium leading-6">Notes</label>
                <textarea id="notes" name="notes" rows="3" class="bg-indigo-100 mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"></textarea>
            </div>

            <div class="flex items-center">
                <input type="checkbox" id="medication" name="medication" class="h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600">
                <label for="medication" class="ml-2 block text-sm">Medication Taken</label>
            </div>
    
            <div id="medicationDetails" class="hidden space-y-4">
                <h3 class="text-lg font-medium leading-6">Medication Details</h3>
                <div>
                    <label for="medName" class="block text-sm font-medium leading-6">Name</label>
                    <input type="text" id="medName" name="medications[0][name]" class="mt-1 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                </div>
                <div>
                    <label for="medDose" class="block text-sm font-medium leading-6">Dose</label>
                    <input type="text" id="medDose" name="medications[0][dose]" class="mt-1 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                </div>
                <div>
                    <label for="medQuantity" class="block text-sm font-medium leading-6">Quantity</label>
                    <input type="number" id="medQuantity" name="medications[0][quantity]" min="0" class="mt-1 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
                </div>
            </div>

            <div>
                <label for="triggers" class="block text-sm font-medium leading-6">Triggers</label>
                <input type="text" id="triggers" name="triggers" class="bg-indigo-100 mt-2 block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6">
            </div>

            <button type="submit" class="flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">Record Migraine Event</button>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
      const medicationCheckbox = document.getElementById('medication');
      const medicationDetails = document.getElementById('medicationDetails');
    
      function toggleMedicationDetails() {
        medicationDetails.classList.toggle('hidden', !medicationCheckbox.checked);
    }
    
    medicationCheckbox.addEventListener('change', toggleMedicationDetails);

    // Initial check in case the checkbox is checked by default
    toggleMedicationDetails();
    });

    document.addEventListener('DOMContentLoaded', function() {
        const dateInput = document.getElementById('date');
        
        // Get today's date in YYYY-MM-DD format
        const today = new Date().toISOString().split('T')[0];
        
        // Set the default value to today's date
        dateInput.value = today;
        
        // Set the max attribute to today's date
        dateInput.setAttribute('max', today);
    });
</script>